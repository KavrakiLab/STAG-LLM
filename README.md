# STAG-LLM: Structure-Aware Graph-based Language Model for TCR-pMHC Binding Prediction

This repository contains the code for STAG-LLM, a novel model for predicting TCR-pMHC binding specificity by integrating sequence information from a pre-trained Large Language Model (ESM-2) with structural insights captured by a Graph Neural Network (GNN).

## Model Architecture

The STAG-LLM model combines sequence embeddings generated by a fine-tuned ESM-2 model with graph representations derived from protein complex structures. These two modalities are then combined for binding specificity prediction.

![STAG-LLM Architecture](STAG_LLM_image.png-f8bfdb13-de7b-40e8-ad16-f626a61d0c94)

## Data Preparation

**IMPORTANT:** Before running any code, you must download the `data` folder, which contains the raw input data for the project. Please download it from \[Insert Data Download Link Here\] and place it in the root directory of this project.

After downloading the `data` folder, you need to unzip and preprocess the PDB files to convert them into graph representations that can be used by the model.
Run the `pdbs_to_graphs.py` script:

   ```
   python pdbs_to_graphs.py
   
   ```

## Training the Model

To replicate the experiments from the paper and train the STAG-LLM model from scratch:

```
python train.py

```

Training progress and evaluation metrics will be logged in the `test` directory (or the directory configured in `train.py`).

## Using Pretrained Models for Evaluation

Pretrained models are provided in the `pretrained_models` directory. You can use these models to score individual input PDB files or evaluate on a test set.

1. Place your input PDB files in a designated directory.

2. Run the `evaluate.py` script:

   ```
   python evaluate.py --model_path path/to/your/pretrained_model.pt --input_pdb path/to/your/input.pdb
   
   ```

## Project Structure

```
.
├── data/
│   ├── full_seq_df_new.csv
│   └── final_dataset_modeled.csv
│   └── top_structures.zip (pdb data files)
├── hetero_edge_graphs/ (generated by pdbs_to_graphs.py)
├── pretrained_models/
│   └── ... (pretrained model checkpoints)
├── requirements.txt
├── train.py
├── model.py
├── data_handling.py
├── utils.py
├── pdbs_to_graphs.py (conceptual, needs to be implemented/provided)
└── evaluate.py (conceptual, needs to be implemented/provided)
├── README.md
├── STAG_LLM_image.png (image asset)
```
